
CREATE TABLE CUSTOMER(CUST_ID INT(4),CUST_NAME VARCHAR(20),ANNUAL_REVENUE INT(10) DEFAULT 10000,CUST_TYPE VARCHAR(30),PRIMARY KEY(CUST_ID));

CREATE TABLE TRUCK(TRUCK_ID INT,DRIVER_NAME VARCHAR(20),PRIMARY KEY(TRUCK_ID));

CREATE TABLE CITY(CITY_NAME VARCHAR(20),POPULATION INT(20),PRIMARY KEY(CITY_NAME));

CREATE TABLE SHIPMENT(SHIPMENT_ID INT(20),CUST_ID INT(4),WEIGHT INT(4) DEFAULT 10,
TRUCK_ID INT,DESTINATION VARCHAR(20),SHIP_DATE DATE,PRIMARY KEY(SHIPMENT_ID),FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(CUST_ID),FOREIGN KEY(TRUCK_ID)
REFERENCES TRUCK(TRUCK_ID),FOREIGN KEY(DESTINATION) REFERENCES CITY(CITY_NAME));


Q 2. What are the names of customers who have sent packages (shipments) to Mumbai City?
SELECT CUST_NAME FROM CUSTOMER INNER JOIN SHIPMENT ON CUSTOMER.CUST_ID = SHIPMENT.CUST_ID
WHERE SHIPMENT.DESTINATION = "MUMBAI";


Q 3. What are the names and populations of cities that have received shipments weighing over 50 kg?
SELECT DISTINCT CITY.* FROM CITY INNER JOIN SHIPMENT ON CITY.CITY_NAME = SHIPMENT.DESTINATION
WHERE SHIPMENT.WEIGHT > 50;

Q 4. Who are the customers having over 500 in annual revenue who have sent shipments weighing less than 50 Kg?
SELECT CUSTOMER.* FROM CUSTOMER INNER JOIN SHIPMENT
ON CUSTOMER.CUST_ID = SHIPMENT.CUST_ID
WHERE CUSTOMER.ANNUAL_REVENUE > 500 AND SHIPMENT.WEIGHT < 50;

Q 5. Who are the customers having over 1000 in annual revenue who have sent shipments weighing less than 10 kg or have sent a shipment to Mumbai?
SELECT CUSTOMER.* FROM CUSTOMER INNER JOIN SHIPMENT
ON CUSTOMER.CUST_ID = SHIPMENT.CUST_ID
WHERE CUSTOMER.ANNUAL_REVENUE > 1000
AND (SHIPMENT.WEIGHT < 10 OR SHIPMENT.DESTINATION = "MUMBAI");


Q 6. Who are the drivers who have delivered shipments for customers with annual revenue over 2000, to cities with populations over 1000?
SELECT DISTINCT TRUCK.* FROM TRUCK
INNER JOIN SHIPMENT ON TRUCK.TRUCK_ID = SHIPMENT.TRUCK_ID
INNER JOIN CUSTOMER ON CUSTOMER.CUST_ID = SHIPMENT.CUST_ID
INNER JOIN CITY ON CITY.CITY_NAME = SHIPMENT.DESTINATION
WHERE CUSTOMER.ANNUAL_REVENUE > 2000 AND CITY.POPULATION > 1000;

Q 7. Display customers who have same Annual Revenue as “Sunil”.

Q 8. Display shipments with weight greater than average weight of shipments.
 SELECT * FROM CUSTOMER WHERE ANNUAL_REVENUE = (SELECT ANNUAL_REVENUE FROM CUSTOMER WHERE CUST_NAME = "SUNIL");
 EMPTY SET (0.00 SEC)
 SELECT * FROM SHIPMENT WHERE WEIGHT > (SELECT AVG(WEIGHT) FROM SHIPMENT);
